% documentdefinitions.tex
% Macro's not beloning to any specific type of document
% The LuaTeX Version
%
% Author:  Tim Steenvoorden
% Changed: 14 Dec 2011
%
\startenvironment documentdefinitions

\writestatus{environment}{Loading shared definitions}

% -----------------------------------------------------------------------------
% Language
% -----------------------------------------------------------------------------

\setuplanguage[en]
  [spacing=packed]
\setuplanguage[nl]
  [leftquote=\upperleftsinglesixquote,
   rightquote=\upperrightsingleninequote,
   leftquotation=\upperleftdoublesixquote,
   rightquotation=\upperrightdoubleninequote]

\setupquote[2]
  [left={\symbol[leftquotation]},
   right={\symbol[rightquotation]}]
\setupquotation[2]
  [left={\symbol[leftquote]},
   right={\symbol[rightquote]}]

% -----------------------------------------------------------------------------
% Typeface FIXME
% -----------------------------------------------------------------------------

\definefontfeature[tabular][default]
  [tnum=yes]
\definefont[tb][Serif*tabular]

% -----------------------------------------------------------------------------
% Directories
% -----------------------------------------------------------------------------

\setupexternalfigures
  [directory={figuren,afbeeldingen,figures,images,
              ../figuren,../afbeeldingen,../figures,../images}]

% -----------------------------------------------------------------------------
% Emphasize & Alert
% -----------------------------------------------------------------------------

\define[1]\emph
  {{\em #1}}
\definestartstop[emphasize]
  [style=\em]

\define[1]\alert
  {{\ss\bf #1}}

\define[1]\online
  {\useurl[online][#1]
   \url[online]}

\defineparagraphs[sidebysidetext]
  [n=2]

% -----------------------------------------------------------------------------
% Todo's
% -----------------------------------------------------------------------------

%\definelist[todo]
  %[alternative=a,
   %partnumber=no,
   %pagestyle=\quad\it]
%\definecombinedlist[todos]
  %[chapter,todo]
%\setupcombinedlist[todos]
  %[level=current,% Waarom weet ik ook niet, maar het werkt.
   %interaction=pagenumber]

\defineregister[todos]
\setupregister[todos]
  [n=1,
   indicator=no,
   before={\blank[none]}]

\starttexdefinition todo
  \dodoublegroupempty\dotodo
\stoptexdefinition

\starttexdefinition dotodo #1#2
  \doifemptyelse{#2}
    {\inmargin{Todo}
     \underbar{#1}
     \todos{Todo+#1}}
    {\inmargin{#1}
     \underbar{#2}
     \todos{#1+#2}}
\stoptexdefinition

% -----------------------------------------------------------------------------
% Referencing
% -----------------------------------------------------------------------------

\starttexdefinition see [#1:#2]
  \doifdefinedelse{in#1}
    {\getvalue{in#1}[#1:#2]}
    {\writestatus{warning}{referenceformat in#1 not defined}
     \in[#1:#2]}
\stoptexdefinition

\definereferenceformat[insec]
  [left=ยง]
\definereferenceformat[inchp]
  [text=\labeltext{chapter}]
\definereferenceformat[inapp]
  [text=\labeltext{appendix}]
\definereferenceformat[infig]
  [text=\labeltext{figure}]
\definereferenceformat[intab]
  [text=\labeltext{table}]
\definereferenceformat[infor]
  [left=(,
   right=)]

% -----------------------------------------------------------------------------
% Math Commands
% -----------------------------------------------------------------------------

\usemodule[mathsets]

\definemathcommand[arcsinh][nolop]
  {\mfunction{arcsinh}}
\definemathcommand[arccosh][nolop]
  {\mfunction{arccosh}}
\definemathcommand[arctanh][nolop]
  {\mfunction{arctanh}}
\definemathcommand[e][nolop]
  {\mfunction{e}}

\definemathset[bra]
  [left=\langle,
   right=\vert]
\definemathset[ket]
  [left=\vert,
   right=\rangle]
\definemathset[braket]
  [left=\langle,
   right=\rangle]
\definemathset[com]
  [left={[},
   middle={,},
   right={]}]
\definemathset[anticom]
  [middle={,}]
\definemathset[expect]
  [left=\langle,
   right=\rangle]

\redefine\d
  {{\rm d}}
\define[2]\tdiff
  {\frac{\d #1}{\d #2}}
\define[1]\dd
  {{\textstyle\tdiff{}{#1}}}
\define\p
  {\partial}
\define[2]\pdiff
  {\frac{\p #1}{\p #2}}
\define[1]\pp
  {{\textstyle\pdiff{}{#1}}}

\define[1]\vec % cannot be \redefine'ed
  {{\bf #1}}
\define[1]\mat % cannot be \redefine'ed
  {\text{\ss\bf #1}}
%\define[1]\op
  %{\hat{#1}}

\define\cross
  {\times}
\define\Grad
  {\vec{\nabla}}
\define[1]\Div
  {\vec{\nabla}\cdot\vec{#1}}
\define[1]\Curl
  {\vec{\nabla}\cross\vec{#1}}
\define\Lapl
  {\vec{\nabla}^2}

\redefine\implies
  {\Rightarrow}
\redefine\iff
  {\Leftrightarrow}
%\define\to
%\define\mapsto
%\define\leadsto

\define[1]\E
  {\math{\cdot 10^{#1}}}
\define\half
  {{\textstyle\frac12}}
\define\third
  {{\textstyle\frac13}}

% -----------------------------------------------------------------------------
% Math Alignment
% -----------------------------------------------------------------------------

\definemathalignment[gather]
  [n=1,
   align=left,
   distance=1em plus 1 fill]

\define\startsplit
  {\dosingleempty\dostartsplit}

\starttexdefinition dostartsplit [#1]#2 \stopsplit
  \define\SC{\NC}
  \define\SR{\NR\NC\NC}
  \startalign[#1]
    \NC #2 \NR[+]
  \stopalign
\stoptexdefinition

\define\startspread
  {\dosingleempty\dostartspread}

\starttexdefinition dostartspread [#1]#2 \stopspread
  \define\SC{\NC}
  \define\SR{\NR\NC}
  \startgather[m=2,#1]
    \NC #2 \NR[+]
  \stopgather
\stoptexdefinition

\define\startsteps
  {\dosingleempty\dostartsteps}

\starttexdefinition dostartsteps [#1]#2 \stopsteps
  \define\SR{\NR\NC\NC\implies\NC}
  \startalign[m=2,#1]
    \NC\NC \NC #2 \NR[+]
  \stopalign
\stoptexdefinition

% -----------------------------------------------------------------------------
% Tabbed data
% -----------------------------------------------------------------------------

\usemodule[database]

\defineseparatedlist[tabbeddata]
  [separator=tab,
   first=\NC,
   right=\NC,
   last=\NR]

\starttexdefinition externaltabbeddata [#1]
  \processseparatedfile[tabbeddata][#1]
\stoptexdefinition

% -----------------------------------------------------------------------------
% Bibliography
% -----------------------------------------------------------------------------

\define\inlinecite
  {\cite[authoryear]}

\stopenvironment

% vim: ts=2 sw=2 et

